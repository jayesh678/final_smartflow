<!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Expenses</title>
      <!-- Bootstrap CSS -->
      <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
      <style>
        /* Custom Styles */
        table {
          border-collapse: collapse;
          width: 100%;
        }
        th, td {
          border: 1px solid #ddd;
          padding: 8px;
          text-align: left;
        }
        th {
          background-color: #f2f2f2;
        }
        .container {
          margin-top: 50px;
        }
        
      </style>
    </head>

    <body class="expense-index">

      <div>
        <h1><center>Expenses</center></h1>
        <% if @expenses.present? %>
        <div class="row">
          <div class="col-md-6">
            <label for="category-filter">Filter by Category Type:</label>
            <select id="category-filter" class="form-control">
              <option value="all">Each Category</option>
              <option value="Travel">Travel</option>
              <option value="Regular">Regular</option>
            </select>
          </div>
        </div>

        <div class="table-responsive mt-3">
          <table class="table">
            <thead>
              <tr>
                <th>Application Number</th>
                <th>Amount</th>
                <th>Expense Date</th>
                <th>User</th>
                <th>Role</th>
                <th>Category</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="expense-table-body">
              <% @expenses.each do |expense| %>
                <tr>
                <td>
                <% if expense.user %>
                  <%= link_to expense.application_number,edit_user_expense_path(user_id: expense.user.id, id: expense.id) %>
                <% else %>
                  <%= expense.application_number %>
                <% end %>
              </td>
              
                  </td>
                  <td><%= expense.amount %></td>
                  <td><%= expense.expense_date.strftime('%Y-%m-%d') %></td>
                  <td><%= "#{expense.user.firstname} #{expense.user.lastname}" %></td>
                  <td><%= expense.user.role.role_name %></td>
                  <td><%= expense.category.category_type %></td>
                  <td><%= expense.status %></td>
                  <td>
                  <%= link_to user_expense_path(user_id: expense.user.id, id: expense.id), class: 'btn btn-primary btn-sm' do %>
                    <i class="fas fa-eye"></i> View
                  <% end %>
                  
                  <%= link_to edit_user_expense_path(user_id: expense.user.id, id: expense.id), class: 'btn btn-secondary btn-sm' do %>
                    <i class="fas fa-edit"></i> Edit
                  <% end %>
                  
                  <%= link_to user_expense_path(user_id: expense.user.id, id: expense.id), data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' }, class: 'btn btn-danger btn-sm' do %>
                    <i class="fas fa-trash-alt"></i> Delete
                  <% end %>
                  
          </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>

        <% end %>

<div class="mt-3">
  <%= link_to new_user_expense_path(user_id: current_user.id), class: 'btn btn-success btn-lg rounded-pill shadow d-inline-flex align-items-center justify-content-center px-4' do %>
    <i class="fas fa-plus-circle fa me-2"></i>
    <span class="d-none d-md-inline">Add Expense</span>
  <% end %>
</div>
      
      <div class="digg_pagination" style="text-align: center; margin-top: 300px;">
          <div class="page_info">
            <%= page_entries_info @expenses %>
          </div>
          <%= will_paginate @expenses, :container => false, :class => 'pagination' %>
        </div>
      </div>

      <style>
        body {
          position: relative;
          min-height: 100vh;
        }
        .content {
          padding-bottom: 100px; /* Adjust as needed to ensure content is above the pagination */
        }
        .digg_pagination {
          background: white;
          position: fixed;
          bottom: 0;
          left: 0;
          width: 100% ;
          z-index: 1000; 
          cursor: default;
        }
        .digg_pagination a,
        .digg_pagination span,
        .digg_pagination em {
          padding: 0.2em 0.5em;
          display: block;
          float: left;
          margin-right: 1px;
        }
        .digg_pagination .disabled {
          color: #999999;
          border: 1px solid #dddddd;
        }
        .digg_pagination .current {
          font-style: normal;
          font-weight: bold;
          background: #2e6ab1;
          color: white;
          border: 1px solid #2e6ab1;
        }
        .digg_pagination a {
          text-decoration: none;
          color: #105cb6;
          border: 1px solid #9aafe5;
        }
        .digg_pagination a:hover,
        .digg_pagination a:focus {
          color: #000033;
          border-color: #000033;
        }
        .digg_pagination .page_info {
          background: #2e6ab1;
          color: white;
          padding: 0.4em 0.6em;
          width: 22em;
          margin-bottom: 0.3em;
          text-align: center;
        }
        .digg_pagination .page_info b {
          color: #000033;
          background: #6aa6ed;
          padding: 0.1em 0.25em;
        }
        .digg_pagination:after {
          content: ".";
          display: block;
          height: 0;
          clear: both;
          visibility: hidden;
        }
        * html .digg_pagination {
          height: 1% ;
        }
        *:first-child + html .digg_pagination {
          overflow: hidden;
        }
      </style>
      <!-- Bootstrap JS and Custom JS -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
      <script src="application.js"></script>
    </body>
    </html>

